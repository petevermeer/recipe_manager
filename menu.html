<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Menu</title>
	<link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w" crossorigin="anonymous">
	<style>
		.imglink{
			cursor: pointer;
		}
		.contan{
			position: relative;
		}
		.overlay {
			position: absolute; 
			top: 5px; 
			right: 5px;
			background: rgba(150, 255, 150, 0.5); /* white see-through */
			width: 18%;
			cursor: pointer;
		}
		a{
			cursor: pointer;
			text-decoration: underline;
			text-color: blue;
		}
	</style>
</head>
<body>
	<div class="pure-menu pure-menu-horizontal">
		<ul class="pure-menu-list">
			<li class="pure-menu-item"><a href="#" class="pure-menu-link" onmousedown="showMenu();">Menu</a></li>
			<li class="pure-menu-item"><a href="#" class="pure-menu-link" onmousedown="showRecipe();">Recipe</a></li>
			<li class="pure-menu-item"><a href="#" class="pure-menu-link"  onmousedown="showShoppingList();">Shopping List</a></li>
		</ul>
	</div>
	<div id='shopping_list' class="pure-u-2-5; hidden">
		<div class='pure-u-1'><h2>Shopping List</h2></div>
	</div>
	<div id='menu' class="pure-u-1"></div>
	<div id='recipe' class="pure-u-1; hidden"></div>
	<script>
		function showMenu(){
			document.getElementById('shopping_list').classList.add('hidden');
			document.getElementById('recipe').classList.add('hidden');
			document.getElementById('menu').classList.remove('hidden');
		}
		function showShoppingList(){
			document.getElementById('menu').classList.add('hidden');
			document.getElementById('recipe').classList.add('hidden');
			document.getElementById('shopping_list').classList.remove('hidden');
		}
		function showRecipe(){
			document.getElementById('menu').classList.add('hidden');
			document.getElementById('shopping_list').classList.add('hidden');
			document.getElementById('recipe').classList.remove('hidden');
		}
		
		function writeRecipe(food){
			var temp = "<h2>"+formatFoodString(food)+"</h2><p><a href='#' onclick='addToShoppingList(\""+food+"\");showMenu();'>add to shopping list</a></p>";
			temp += "<img  width='300px' src='images/"+food+".png'/>";
			temp += "<h3>Ingredients</h3><ul>";
			for( var i = 0; i < menu[food]["recipe"]["ingredients"].length; i++){
				temp += "<li>"+menu[food]["recipe"]["ingredients"][i][2]+" "+menu[food]["recipe"]["ingredients"][i][1]+" "+menu[food]["recipe"]["ingredients"][i][0]+"</li>";
			}
			temp += "</ul>";
			temp += "<h3>Directions</h3><p>";
			temp += menu[food]["recipe"]["directions"];
			temp += "</p>";
			document.getElementById('recipe').innerHTML = temp;
		}
		
		function formatFoodString(food){
			var temp = food.split("_");
			var temp2 = "";
			for (var i = 0;i < temp.length;i++){
				temp2 += temp[i] + " ";
			}
			return temp2;
		}
		
		function addToShoppingList(food){
			if(!menu[food]["selected"]){
				selected_recipes.push(food);
				var temp = menu[food]["recipe"]["ingredients"];
				for(var i = 0;i < temp.length;i++){
					if(temp[i][3] in shopping_list){
						if(temp[i][0] in shopping_list[temp[i][3]]){
							if(temp[i][1] in shopping_list[temp[i][3]][temp[i][0]]){
								shopping_list[temp[i][3]][temp[i][0]][temp[i][1]] += temp[i][2];
							}
							else{
								shopping_list[temp[i][3]][temp[i][0]][temp[i][1]] = temp[i][2];
							}
						}
						else{
							shopping_list[temp[i][3]][temp[i][0]] = {};
							shopping_list[temp[i][3]][temp[i][0]][temp[i][1]] = temp[i][2];
						}
					}
					else{
						shopping_list[temp[i][3]] = {};
						shopping_list[temp[i][3]][temp[i][0]] = {}
						shopping_list[temp[i][3]][temp[i][0]][temp[i][1]] = temp[i][2];
					}
				}
				removeFromMenu(food);
				printShoppingList();
				printMenu();
			}
		}
		
		function removeFromMenu(food){
			console.log("selected "+food+" and removed from menu.");
			menu[food]["selected"] = true;
		}
		
		function printShoppingList(){
			var temp = "<div class='pure-u-1'><h2>Shopping List</h2></div><ul>";
			for(var aisle in shopping_list){
				temp += "<li>"+aisle+"</li><ul>";
				for(var food in shopping_list[aisle]){
					temp += "<li>"+food+"</li><ul>";
					for(var measure in shopping_list[aisle][food]){
						temp += "<li>&#9634 &nbsp"+shopping_list[aisle][food][measure]+" "+measure+"</li>";
					}
					temp += "</ul>";
				}
				temp += "</ul>";
			}
			temp += "</ul>";
			temp += "<h2>Selected Recipes:</h2><ul>";
			for(var i = 0; i < selected_recipes.length; i++){
				temp += "<li>"+selected_recipes[i]+"</li>";
			}
			temp += "</ul>";
			// temp += "<button onclick='emailShoppingList();'>Email this shopping list (Experimental/YMMV)</button>";
			document.getElementById('shopping_list').innerHTML = temp;
		}
		
		function printMenu(){
			var temp_breakfast = "<div id='breakfast' class='pure-g'><div class='pure-u-1'><h2>Breakfast</h2></div>";
			var temp_lunch = "<div id='lunch' class='pure-g'><div class='pure-u-1'><h2>Lunch</h2></div>";
			var temp_dinner = "<div id='dinner' class='pure-g'><div class='pure-u-1'><h2>Dinner</h2></div>";
			var temp_snack = "<div id='snack' class='pure-g'><div class='pure-u-1'><h2>Snack</h2></div>";
			for(var food in menu){
				if(!menu[food]["selected"]){
					console.log(food)
					var temp = "<div class='pure-u-1-5 contan'><img class='overlay' onclick='addToShoppingList(\""+food+"\");' src='images/plus.jpg'/><img class='imglink'  onclick='writeRecipe(\""+food+"\");showRecipe();' width='100%' src='images/"+food+".png' onerror='this.src=\"images/default.png\"'/><p>"+formatFoodString(food)+" (<a onclick='addToShoppingList(\""+food+"\");'>add to list</a>)</p></div>";	
					if(menu[food]["meal"] == "breakfast"){
						temp_breakfast += temp;
					}
					else if(menu[food]["meal"] == "lunch"){
						temp_lunch += temp;				
					}
					else if(menu[food]["meal"] == "dinner"){
						temp_dinner += temp;				
					}
					else if(menu[food]["meal"] == "snack"){
						temp_snack += temp;				
					}
				}
			}
			temp_breakfast += "</div>";
			temp_lunch += "</div>";
			temp_dinner += "</div>";
			temp_snack += "</div>";							
			document.getElementById('menu').innerHTML = temp_breakfast+temp_lunch+temp_dinner+temp_snack;
		}
		
		var shopping_list = {};
		
		var selected_recipes = [];
		
		var menu = {
			"hard_boiled_eggs":{
				"meal":"breakfast",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["eggs","large",4,"dairy"]
					],
					"directions":""
				}
			},
			"pancakes":{
				"meal":"breakfast",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["pancake mix","lbs",1,"dry goods"],
						["butter","tbsp",2, "dairy"],
						["syrup","tbsp",2,"dry goods"]
					],
					"directions":""
				}
			},
			"yogurt_and_granola":{
				"meal":"breakfast",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["yogurt","cup",4,"dairy"],
						["granola","cup",2,"dry goods"],
						["fresh fruit","cup",2,"produce"]
					],
					"directions":""
				}
			},
			"oatmeal":{
				"meal":"breakfast",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["oatmeal","cup",2,"dry goods"],
					],
					"directions":""
				}
			},
			"cereal":{
				"meal":"breakfast",
				"selected":false,
				"staple":true,
				"serves":1,
				"recipe":{
					"ingredients":[
						["milk","cup",0.5,"dairy"],
						["cereal","cup",1,"dry goods"]
					],
					"directions":""
				}
			},
			"peanut_butter_and_jelly":{
				"meal":"lunch",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["bread","slice",8,"bakery"],
						["fruit jelly","tbsp",4,"dry goods"],
						["peanut butter","tbsp",8,"dry goods"]
					],
					"directions":""
				}
			},
			"egg_salad":{
				"meal":"lunch",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["eggs","large",8,"dairy"],
						["mayonnaise","tsp",4,"dry goods"],
						["mustard","tbsp",4,"dry goods"],
						["bread","slice",8,"bakery"]
					],
					"directions":""
				}
			},
			"soup":{
				"meal":"lunch",
				"selected":false,
				"staple":true,
				"serves":2,
				"recipe":{
					"ingredients":[
						["soup","can",1,"dry goods"]
					],
					"directions":""
				}
			},
			"grilled_cheese":{
				"meal":"lunch",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["bread","slice",8,"bakery"],
						["cheese","slice",8,"dairy"],
						["butter","tbsp",8,"dairy"]
					],
					"directions":""
				}
			},
			"sausage_frittata":{
				"meal":"dinner",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["breakfast sausage","lbs",1,"meat"],
						["spinach","handful",1,"produce"],
						["onion","small",1,"produce"],
						["potato","small",1,"produce"],
						["shredded parmesan cheese","handful",1,"dairy"],
						["eggs","large",8,"dairy"],
						["butter","tbsp",1,"dairy"]
					],
					"directions":"fry sausage in a non-stick skillet over mid-high heat until it is no longer pink. add in veggies and cheese and fry until onions are soft. pour egg mix over meat and veggies, cover, and let cook for 5 minutes. un cover and broil for another 4 minutes. serve with fruit salad or a spring mix."
				}
			},
			"apple_slices":{
				"meal":"snack",
				"selected":false,
				"staple":true,
				"serves":2,
				"recipe":{
					"ingredients":[
						["eating apple","medium",1,"produce"],
					],
					"directions":""
				}
			},
			"cilantro_chicken_and_tomato_avocado_salsa":{
				"meal":"dinner",
				"selected":false,
				"staple":false,
				"serves":4,
				"recipe":{
					"ingredients":[
						["skinless chicken thighs","lbs",2,"meat"],
						["garlic","cloves",4,"produce"],
						["cilantro","bunch",1,"produce"],
						["olive oil","tbsp",2,"dry goods"],
						["cherry tomatos","pint",1,"produce"],
						["avocados","whole",2,"produce"],
						["red onion","whole",1,"produce"],
						["lime","whole",1,"produce"]
					],
					"directions":"half the cilantro, oil, and lime juice into two bowls. Put the chicken in one with the garlic to marinate. Dice the onion, tomatos and avocados and put in the other bowl. Grill the chicken yo. Put it all on a plate and consume."
				}
			},
			"grilled_peanut_butter_banana_sandwich":{
				"meal":"lunch",
				"selected":false,
				"staple":false,
				"serves":4,
				"recipe":{
					"ingredients":[
						["peanut butter","tbsp",8,"dry goods"],
						["butter","tbsp",4,"dry goods"],						
						["bananas","whole",4,"produce"],
						["bread","slice",8,"bakery"],						
					],
					"directions":"it's just like a grilled cheese, but you gotta put sliced bananas and PB in the bread instead."
				}
			},
			"baked_chicken":{
				"meal":"dinner",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["skinless chicken breasts","lbs",2,"meat"],
						["olive oil","tbsp",2,"dry goods"]
					],
					"directions":"Bake at 350 until internal temp is 165. Season to taste."
				}
			},
			"berries":{
				"meal":"snack",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["berries","pint",1,"produce"]
					],
					"directions":"Duh."
				}
			},
			"crackers_and_cheese":{
				"meal":"snack",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["crackers","package",1,"dry goods"],
						["cheese","lbs",0.5,"dairy"]
					],
					"directions":"You can just use old french bread to make croutons instead if you want."
				}
			},
			"mac_and_cheese":{
				"meal":"dinner",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["bluebox","package",1,"dry goods"],
						["butter","tbsp",2,"dairy"],
						["milk","tbsp",2,"dairy"]
					],
					"directions":"see the box for details. You can get away with a little less butter if you need to. You can also add a can of tuna or peas to spice it up."
				}
			},
			"spaghetti_and_meat_sauce":{
				"meal":"dinner",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["ground beef","lbs",1,"meat"],
						["noodles","cups",2,"dry goods"],
						["pasta sauce","bottle",1,"dry goods"]
					],
					"directions":"Boil the pasta and strain. Brown beef. Mix sauce and beef and noodles and cook to combine."
				}
			},
			"toast":{
				"meal":"snack",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["bread","slice",4,"bakery"],
						["butter","tbsp",1,"dairy"]
					],
					"directions":"toast that breadzo. throw some pb or jam on that to really janx it up."
				}
			},
			"goldfish":{
				"meal":"snack",
				"selected":false,
				"staple":true,
				"serves":4,
				"recipe":{
					"ingredients":[
						["goldfish crackers","handfuls",4,"dry goods"]
					],
					"directions":"You can do it."
				}
			}
			
			
		}
		window.onload = printMenu();
	</script>
</body>
</html>
